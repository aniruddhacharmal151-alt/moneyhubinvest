<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MoneyHub Invest | Premium Fintech</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="h-full">
  <div id="app" class="app-shell page-transition">
    <header class="topbar">
      <div class="brand">
        <div class="brand-mark">₹</div>
        <span>MoneyHub Invest</span>
      </div>

      <button id="menu-toggle" class="hamburger" aria-label="Toggle menu">☰</button>

      <nav id="main-nav" class="nav-links">
        <a href="#offers" data-route="marketing">Offers</a>
        <a href="#slots" data-route="marketing">Plans</a>
        <a href="#how" data-route="marketing">How it works</a>
        <a href="#dashboard" data-route="dashboard" class="user-only">Dashboard</a>
        <a href="#admin" data-route="admin" class="admin-only">Admin</a>
      </nav>

      <div id="auth-buttons" class="auth-buttons">
        <button onclick="window.UI.openAuthModal('login')" class="btn ghost">Login</button>
        <button onclick="window.UI.openAuthModal('signup')" class="btn primary">Sign Up</button>
      </div>

      <div id="user-menu" class="user-menu hidden">
        <button onclick="window.Payments.openDepositModal()" class="btn primary">Deposit</button>
        <button onclick="window.UI.openModal('withdraw')" class="btn ghost">Withdraw</button>
        <button id="profile-trigger" class="btn soft">
          <span id="user-balance">₹0</span>
        </button>
      </div>
    </header>

    <main id="main-content" class="content">
      <section id="marketing-view">
        <section id="offers" class="hero card">
          <p class="kicker">Premium Wealth Growth</p>
          <h1>Invest with confidence in a secure, modern fintech platform.</h1>
          <p>Build your portfolio with premium plans, transparent payouts, and protected transactions.</p>
          <button class="btn primary" onclick="window.App.checkAuthAndDeposit(5000)">Start Investing</button>
        </section>

        <section id="slots" class="plans-section">
          <h2>Investment Plans</h2>
          <div class="plans-grid">
            <article class="plan-card"><h3>Starter</h3><p>₹2,000 - ₹4,999</p><small>30 Days</small><button class="btn soft" onclick="window.App.checkAuthAndDeposit(2000)">Choose</button></article>
            <article class="plan-card"><h3>Silver</h3><p>₹5,000 - ₹9,999</p><small>45 Days</small><button class="btn soft" onclick="window.App.checkAuthAndDeposit(5000)">Choose</button></article>
            <article class="plan-card featured"><h3>Gold</h3><p>₹10,000 - ₹20,000</p><small>65 Days</small><button class="btn primary" onclick="window.App.checkAuthAndDeposit(10000)">Choose</button></article>
            <article class="plan-card"><h3>Emerald</h3><p>₹20,000+</p><small>90 Days</small><button class="btn soft" onclick="window.App.checkAuthAndDeposit(20000)">Choose</button></article>
          </div>
        </section>

        <section id="how" class="card how-grid">
          <div><strong>1</strong><p>Secure signup with OTP verification.</p></div>
          <div><strong>2</strong><p>Fund wallet with Razorpay protected checkout.</p></div>
          <div><strong>3</strong><p>Track real and bonus balances live.</p></div>
          <div><strong>4</strong><p>Withdrawals are admin-reviewed for security.</p></div>
        </section>
      </section>

      <section id="dashboard-layout" class="hidden">
        <div class="dashboard-grid">
          <aside class="card sidebar-panel">
            <h3>Wallet</h3>
            <p>Real Balance</p>
            <h2 id="dashboard-real-balance">₹0</h2>
            <p>Bonus Balance</p>
            <h2 id="dashboard-bonus-balance">₹0</h2>
            <p id="bonus-note">Bonus capped at ₹500 and not withdrawable.</p>
            <button id="claim-bonus-btn" class="btn soft">Claim Daily Bonus</button>
          </aside>

          <section class="card">
            <h3>Premium Deposits</h3>
            <p>Secure payments powered by Razorpay</p>
            <p class="small-text">Supports UPI, net banking, cards, and wallets.</p>
            <button class="btn primary" onclick="window.Payments.openDepositModal()">Deposit with Razorpay</button>
          </section>

          <section id="transactions-section" class="card">
            <h3>Transactions</h3>
            <table>
              <thead><tr><th>Type</th><th>Amount</th><th>Status</th><th>Date</th></tr></thead>
              <tbody id="transactions-table"></tbody>
            </table>
          </section>

          <section id="referral-section" class="card">
            <h3>Referral</h3>
            <p>Your code: <strong id="referral-code">—</strong></p>
            <p>Total referrals: <strong id="total-referrals">0</strong></p>
            <p>Earnings: <strong id="referral-earnings">₹0</strong></p>
          </section>
        </div>
      </section>

      <section id="admin-panel" class="hidden card">
        <h3>Withdrawal Approval Panel</h3>
        <table>
          <thead><tr><th>User</th><th>Amount</th><th>UPI</th><th>Status</th><th>Action</th></tr></thead>
          <tbody id="admin-withdrawals-table"></tbody>
        </table>
      </section>
    </main>

    <div id="auth-modal" class="modal hidden">
      <div class="modal-card">
        <button class="close" onclick="window.UI.closeAuthModal()">✕</button>
        <div class="tabs">
          <button id="tab-login" onclick="window.Auth.showLogin()" class="active">Login</button>
          <button id="tab-signup" onclick="window.Auth.showSignup()">Signup</button>
        </div>
        <div id="login-section">
          <form id="login-form">
            <input id="login-email" type="email" placeholder="Email" required />
            <input id="login-password" type="password" placeholder="Password" required />
            <button class="btn primary" type="submit">Login</button>
          </form>
        </div>
        <div id="signup-section" class="hidden">
          <div id="signup-step-email">
            <input id="signup-email" type="email" placeholder="Email" required />
            <button class="btn primary" onclick="window.Auth.sendSignupOtp()">Send OTP</button>
          </div>
          <div id="signup-step-otp" class="hidden">
            <input id="signup-otp" type="text" placeholder="Enter OTP" required />
            <button class="btn primary" onclick="window.Auth.verifySignupOtp()">Verify OTP</button>
          </div>
          <div id="signup-step-password" class="hidden">
            <input id="signup-password" type="password" placeholder="Create Password" required />
            <button class="btn primary" onclick="window.Auth.finishSignup()">Create Account</button>
          </div>
        </div>
      </div>
    </div>

    <div id="deposit-modal" class="modal hidden">
      <div class="modal-card deposit-modal-card">
        <button class="close" onclick="window.UI.closeModal('deposit')">✕</button>
        <h3>Deposit Funds</h3>
        <form id="deposit-form">
          <input type="number" id="deposit-amount" required min="2000" step="100" placeholder="Minimum ₹2,000" />
          <input type="hidden" id="deposit-method" value="razorpay" />
          <div id="deposit-error" class="hidden error"></div>
          <div id="deposit-success" class="hidden success"></div>
          <button type="submit" id="deposit-btn" class="btn primary">Pay Securely</button>
        </form>
      </div>
    </div>

    <div id="withdraw-modal" class="modal hidden">
      <div class="modal-card">
        <button class="close" onclick="window.UI.closeModal('withdraw')">✕</button>
        <h3>Withdraw</h3>
        <p>Withdrawable (real balance): <span id="withdraw-balance">₹0</span></p>
        <form id="withdraw-form">
          <input type="number" id="withdraw-amount" required min="1000" step="100" placeholder="Amount" />
          <input type="text" id="withdraw-upi" required placeholder="yourname@upi" />
          <div id="withdraw-error" class="hidden error"></div>
          <div id="withdraw-success" class="hidden success"></div>
          <button type="submit" id="withdraw-btn" class="btn primary">Request Withdrawal</button>
        </form>
      </div>
    </div>

    <div id="toast-container"></div>
  </div>

  <script type="module" src="js/app.js"></script>
</body>
</html>
